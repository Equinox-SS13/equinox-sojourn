//Female ants are basically what they are in real life, big and command a bunch of drones.
/mob/living/carbon/superior_animal/ant/female
	name = "Female Crazy Ant"
	desc = "A humungous yellow crazy ant. This one's a female, and usually is seen with a cadre of other ants."
	icon_state = "fuhrer"

	turns_per_move = 4
	maxHealth = 125 * ROACH_HEALTH_MOD
	health = 125 * ROACH_HEALTH_MOD

	knockdown_odds = 5
	melee_damage_lower = 15
	melee_damage_upper = 30
	move_to_delay = 8
	mob_size = MOB_MEDIUM
	get_stat_modifier = TRUE
	var/distress_level = 0
	var/distress_calls = 1 //Each ant can only call for help once in its life
	var/retreat_calls = 1 //Can call for retreat once too
	extra_burrow_chance = 100
	blattedin_revives_left = 0 //Only gets one

	flash_resistances = 5 //Halved flash stun.

	armor = list(melee = 15, bullet = 15, energy = 5, bomb = 5, bio = 20, rad = 0, agony = 0)
	armor_penetration = 25

	meat_type = /obj/item/reagent_containers/food/snacks/meat/roachmeat/fuhrer/ant
	meat_amount = 6

	sanity_damage = 1

	inherent_mutations = list(MUTATION_ROACH_BLOOD, MUTATION_ROACH_FRIEND, MUTATION_DEAF, MUTATION_TOURETTES, MUTATION_EPILEPSY)

/mob/living/carbon/superior_animal/ant/fuhrer/bullet_act(var/obj/item/projectile/P)
	.=..()
	if (!(P.testing))
		distress_call()

/mob/living/carbon/superior_animal/ant/fuhrer/attackby()
	.=..()
	distress_call()

/*When its subordinates die, the leader may call for aid.
It may also call when it is personally under attack
Every nearby ant death triggers this proc, and increases the chance of a call
All the burrows in a wide area will request rapid reinforcements, causing a significant number of ants to
flood into this room and surrounding ones.

Each leader can only call reinforcements once in its life. But it can also sound an evacuation once. If it has no
reinforcements left it will attempt to evacuate*/
/mob/living/carbon/superior_animal/ant/fuhrer/proc/distress_call()
	if(stat != CONSCIOUS) // if the roach is conscious
		return
	if(stat != AI_inactive)
		return
	if (!distress_calls && !retreat_calls)
		return
	distress_level += 1

	//In order to make it more likely that players will be around to witness it, lets add more distress if we can see a human player
	for (var/mob/living/carbon/human/H in view())
		if (H.stat != DEAD && H.client)
			distress_level += 2
			break

	if (distress_level > 0 && prob(distress_level))
		distress_level = -30 //Once a call is successfully triggered, we don't want one for a WHILE. Setting it to negative makes sure it doesn't happen for a good long time.
		if (distress_calls)
			distress_calls--
			playsound(src.loc, 'sound/voice/shriek1.ogg', 100, 1, 8, 8)
			spawn(2)
				playsound(src.loc, 'sound/voice/shriek1.ogg', 100, 1, 8, 8)	//Playing the sound twice will make it sound really horrible
			visible_message(SPAN_DANGER("[src] emits a horrifying wail as nearby burrows stir to life!"))
			//Add all nearby burrows to the distressed burrows list
			for (var/obj/structure/burrow/B in find_nearby_burrows())
				B.distress(TRUE)

		//If no distress calls available, sound a retreat instead
		else if (retreat_calls)
			retreat_calls --
			playsound(src.loc, 'sound/voice/hiss6.ogg', 100, 1, 8, 8)
			spawn(2)
				playsound(src.loc, 'sound/voice/hiss6.ogg', 100, 1, 8, 8)	//Playing the sound twice will make it sound really horrible
			visible_message(SPAN_DANGER("[src] emits a haunting scream as it turns to flee, taking the nearby horde with it...."))
			for (var/obj/structure/burrow/B in find_nearby_burrows())
				B.evacuate()

/mob/living/carbon/superior_animal/ant/fuhrer/slip(var/slipped_on,stun_duration=8)
	return FALSE
